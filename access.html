<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tailwind CSSの読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts M PLUS 1p (400, 700) の読み込み -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@400;700&display=swap" rel="stylesheet">
    
    <title id="page-title">人の成長戦略会議 - 課題マップ D2</title>

    <style>
        /* M PLUS 1p フォントを全体に適用 */
        body {
            font-family: 'M PLUS 1p', sans-serif;
            background-color: #000;
            color: #E5E7EB; /* text-gray-200 */
            overflow-x: hidden;
        }

        /* B. オーロラ背景 (::before)
          複数のグラデーションをブレンドモードで重ね、アニメーションで動かす 
        */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            background: 
                radial-gradient(at 0% 0%, #3a0050 0%, transparent 70%),
                radial-gradient(at 100% 0%, #0a012e 0%, transparent 70%),
                radial-gradient(at 0% 100%, #8b0000 0%, transparent 70%),
                radial-gradient(at 100% 100%, #0d015c 0%, transparent 70%),
                radial-gradient(at 50% 50%, #4a0050 0%, transparent 70%);
            background-blend-mode: screen;
            filter: blur(80px);
            animation: backgroundShift 30s ease-in-out infinite alternate;
        }

        /* 背景アニメーション */
        @keyframes backgroundShift {
            0% {
                transform: scale(1);
                background-position: 0% 0%, 100% 0%, 0% 100%, 100% 100%, 50% 50%;
            }
            100% {
                transform: scale(1.1);
                background-position: 10% 5%, 90% 5%, 5% 95%, 95% 90%, 45% 55%;
            }
        }

        /* D. アニメーションキーフレーム 
        */
        @keyframes fade-in-down {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-in {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        @keyframes slide-in-left {
            0% { opacity: 0; transform: translateX(-30px); }
            100% { opacity: 1; transform: translateX(0); }
        }
        @keyframes slide-in-right {
            0% { opacity: 0; transform: translateX(30px); }
            100% { opacity: 1; transform: translateX(0); }
        }
        @keyframes slide-in-top {
            0% { opacity: 0; transform: translateY(-30px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        @keyframes slide-in-bottom {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        /* 弾むようなアニメーション */
        @keyframes pop-in {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }
        /* 明滅アニメーション */
        @keyframes pulse-light {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* D. ユーティリティクラス 
        */
        .animate-fade-in-down { animation: fade-in-down 0.8s ease-out forwards; }
        .animate-fade-in-up { animation: fade-in-up 0.8s ease-out forwards; }
        .animate-fade-in { animation: fade-in 1s ease-out forwards; }
        .animate-fade-in-delay { animation: fade-in 1s ease-out 0.8s forwards; opacity: 0; }
        .animate-slide-in-left { animation: slide-in-left 0.8s ease-out forwards; opacity: 0; }
        .animate-slide-in-right { animation: slide-in-right 0.8s ease-out forwards; opacity: 0; }
        .animate-slide-in-top { animation: slide-in-top 0.8s ease-out 0.4s forwards; opacity: 0; }
        .animate-slide-in-bottom { animation: slide-in-bottom 0.8s ease-out 0.4s forwards; opacity: 0; }
        .animate-pop-in { animation: pop-in 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; }
        .animate-pulse-light { animation: pulse-light 2.5s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* カスタムスタイル */
        .writing-mode-vertical-rl { writing-mode: vertical-rl; }
        .shadow-glow { box-shadow: 0 0 15px rgba(168, 85, 247, 0.7); }
        
        /* ツールチップのホバーアニメーション */
        .group .tooltip {
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
            transform: translate(-50%, 0);
            z-index: 100; /* プライマリー */
        }
        .group:hover .tooltip {
            transform: translate(-50%, -10px);
            z-index: 100; /* ホバー時も維持 */
        }
        
        /* A. スクロールバーのカスタマイズ 
        */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(31, 41, 55, 0.3); /* gray-800/30 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.5); /* violet-500/50 */
            border-radius: 10px;
            border: 2px solid transparent;
            background-clip: content-box;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(168, 85, 247, 0.8); /* violet-500/80 */
        }

        /* D. 編集機能のスタイル 
        */
        [contenteditable="true"] {
            outline: 2px dashed rgba(255, 255, 255, 0.5);
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            cursor: text;
        }
        [contenteditable="true"]:hover,
        [contenteditable="true"]:focus {
            background-color: rgba(255, 255, 255, 0.15);
            outline: 2px dashed rgba(255, 255, 255, 0.8);
        }

        #edit-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }

        #edit-controls button {
            background-color: rgba(255, 255, 255, 0.9);
            color: #333;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }

        #edit-controls button:hover {
            background-color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        #edit-controls #save-button,
        #edit-controls #cancel-button {
            display: none;
        }

        #edit-controls #save-button {
            background-color: #4CAF50; /* Green */
            color: white;
        }
        #edit-controls #save-button:hover { background-color: #45a049; }

        #edit-controls #reset-button {
            background-color: #f44336; /* Red */
            color: white;
        }
        #edit-controls #reset-button:hover { background-color: #d32f2f; }

        #edit-controls #cancel-button {
            background-color: #757575; /* Gray */
            color: white;
        }
        #edit-controls #cancel-button:hover { background-color: #616161; }
    </style>
</head>
<body class="bg-black text-gray-200 selection:bg-purple-500 selection:text-white">

    <!-- 1. タイトルセクション -->
    <section class="relative py-16 md:py-24 flex items-center justify-center min-h-[40vh] md:min-h-[50vh] overflow-hidden">
        <div class="text-center z-10 p-4">
            <h1 id="main-title" data-editable="true" class="text-5xl md:text-7xl font-bold text-white drop-shadow-lg animate-fade-in-down" style="animation-delay: 0s;">
                人の成長戦略会議
            </h1>
            <p id="sub-title" data-editable="true" class="text-2xl md:text-3xl text-gray-300 opacity-80 mt-4 drop-shadow animate-fade-in-up" style="animation-delay: 0.2s;">
                - 2025年度 D2 課題マップ -
            </p>
        </div>
        <!-- 装飾ライン -->
        <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-2/3 md:w-1/3 h-1 bg-gradient-to-r from-transparent via-purple-500 to-transparent animate-pulse-light"></div>
    </section>

    <!-- 2. 4象限バブルチャートセクション -->
    <section class="container mx-auto px-4 py-16 md:py-24">
        <h2 id="quadrant-title" data-editable="true" class="text-4xl font-bold text-center mb-16 text-white animate-fade-in" style="animation-delay: 0.4s;">
            D2 課題クラスターマップ
        </h2>

        <!-- PC用 4象限コンテナ -->
        <div class="hidden md:block relative bg-black bg-opacity-30 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-700/50 p-8 md:p-16 animate-fade-in-delay">
            
            <!-- 軸ラベル (固定) -->
            <div id="axis-y-top" data-editable="true" class="text-center mb-12 text-2xl font-bold text-white opacity-90 animate-slide-in-top">
                マネジメント層の課題
            </div>
            
            <!-- 象限グリッドと軸線 -->
            <div class="relative">
                <!-- 縦軸線 -->
                <div class="absolute top-0 left-1/2 -translate-x-1/2 w-1 h-full bg-gradient-to-b from-purple-600 via-purple-400 to-purple-600 rounded-full shadow-glow animate-fade-in" style="animation-delay: 1.2s;"></div>
                <!-- 横軸線 -->
                <div class="absolute top-1/2 left-0 -translate-y-1/2 w-full h-1 bg-gradient-to-r from-purple-600 via-purple-400 to-purple-600 rounded-full shadow-glow animate-fade-in" style="animation-delay: 1.2s;"></div>
                
                <!-- 4象限グリッド (重要: overflow-hiddenは設定しない) -->
                <div class="relative grid grid-cols-2 grid-rows-2 rounded-2xl border border-gray-700/30">
                    
                    <!-- 象限③ (左上: マネ × メンタル) -->
                    <div id="quadrant-3" class="relative bg-gradient-to-br from-[#1A203F] to-[#0A102F] rounded-tl-2xl border-r border-b border-gray-700/30 flex flex-wrap gap-5 items-center justify-center content-center p-6 min-h-[400px]">
                        <!-- JSでバブルが挿入される -->
                    </div>

                    <!-- 象限① (右上: マネ × スキル) -->
                    <div id="quadrant-1" class="relative bg-gradient-to-bl from-[#1A3F20] to-[#0A2F10] rounded-tr-2xl border-l border-b border-gray-700/30 flex flex-wrap gap-5 items-center justify-center content-center p-6 min-h-[400px]">
                        <!-- JSでバブルが挿入される -->
                    </div>

                    <!-- 象限④ (左下: 現場 × メンタル) -->
                    <div id="quadrant-4" class="relative bg-gradient-to-tr from-[#3F1A20] to-[#2F0A10] rounded-bl-2xl border-r border-t border-gray-700/30 flex flex-wrap gap-5 items-center justify-center content-center p-6 min-h-[400px]">
                        <!-- JSでバブルが挿入される -->
                    </div>

                    <!-- 象限② (右下: 現場 × スキル) -->
                    <div id="quadrant-2" class="relative bg-gradient-to-tl from-[#3F3A1A] to-[#2F2A0A] rounded-br-2xl border-l border-t border-gray-700/30 flex flex-wrap gap-5 items-center justify-center content-center p-6 min-h-[400px]">
                        <!-- JSでバブルが挿入される -->
                    </div>
                </div>
            </div>

            <!-- 軸ラベル (固定) -->
            <div id="axis-y-bottom" data-editable="true" class="absolute bottom-0 left-1/2 -translate-x-1/2 mb-4 text-2xl font-bold text-white opacity-90 animate-slide-in-bottom">
                現場層の課題
            </div>
            <div id="axis-x-left" data-editable="true" class="absolute top-1/2 left-0 -translate-y-1/2 -ml-20 text-2xl font-bold text-white opacity-90 writing-mode-vertical-rl rotate-180 animate-slide-in-left" style="animation-delay: 0.6s;">
                メンタル・士気
            </div>
            <div id="axis-x-right" data-editable="true" class="absolute top-1/2 right-0 -translate-y-1/2 -mr-20 text-2xl font-bold text-white opacity-90 writing-mode-vertical-rl animate-slide-in-right" style="animation-delay: 0.6s;">
                スキル・成長
            </div>

        </div>

        <!-- スマホ用 縦積みコンテナ -->
        <div class="md:hidden space-y-8 animate-fade-in-delay">
            
            <!-- 象限③ (左上: マネ × メンタル) -->
            <div class="bg-black bg-opacity-30 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-700/50 overflow-hidden">
                <div class="p-4 border-b border-gray-700/50">
                    <h3 id="mobile-q3-title" data-editable="true" class="text-xl font-bold text-center p-2 rounded-lg bg-gradient-to-r from-blue-700 to-blue-900 animate-pulse-light">
                        マネジメント層 × メンタル・士気
                    </h3>
                </div>
                <div id="quadrant-3-mobile" class="flex flex-wrap gap-4 items-center justify-center content-center p-4 min-h-[250px]">
                    <!-- JSでバブルが挿入される -->
                </div>
            </div>

            <!-- 象限① (右上: マネ × スキル) -->
            <div class="bg-black bg-opacity-30 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-700/50 overflow-hidden">
                <div class="p-4 border-b border-gray-700/50">
                    <h3 id="mobile-q1-title" data-editable="true" class="text-xl font-bold text-center p-2 rounded-lg bg-gradient-to-r from-green-700 to-green-900 animate-pulse-light">
                        マネジメント層 × スキル・成長
                    </h3>
                </div>
                <div id="quadrant-1-mobile" class="flex flex-wrap gap-4 items-center justify-center content-center p-4 min-h-[250px]">
                    <!-- JSでバブルが挿入される -->
                </div>
            </div>

            <!-- 象限④ (左下: 現場 × メンタル) -->
            <div class="bg-black bg-opacity-30 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-700/50 overflow-hidden">
                <div class="p-4 border-b border-gray-700/50">
                    <h3 id="mobile-q4-title" data-editable="true" class="text-xl font-bold text-center p-2 rounded-lg bg-gradient-to-r from-red-700 to-red-900 animate-pulse-light">
                        現場層 × メンタル・士気
                    </h3>
                </div>
                <div id="quadrant-4-mobile" class="flex flex-wrap gap-4 items-center justify-center content-center p-4 min-h-[250px]">
                    <!-- JSでバブルが挿入される -->
                </div>
            </div>

            <!-- 象限② (右下: 現場 × スキル) -->
            <div class="bg-black bg-opacity-30 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-700/50 overflow-hidden">
                <div class="p-4 border-b border-gray-700/50">
                    <h3 id="mobile-q2-title" data-editable="true" class="text-xl font-bold text-center p-2 rounded-lg bg-gradient-to-r from-yellow-700 to-yellow-900 animate-pulse-light">
                        現場層 × スキル・成長
                    </h3>
                </div>
                <div id="quadrant-2-mobile" class="flex flex-wrap gap-4 items-center justify-center content-center p-4 min-h-[250px]">
                    <!-- JSでバブルが挿入される -->
                </div>
            </div>

        </div>
    </section>

    <!-- 3. 総括セクション -->
    <section class="relative container mx-auto px-4 py-16 md:py-24">
        <div class="relative bg-black bg-opacity-30 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-700/50 p-8 md:p-16">
            <h2 id="summary-title" data-editable="true" class="text-4xl font-bold text-center mb-12 text-white animate-fade-in" style="animation-delay: 0.2s;">
                総括：4象限から見る主要課題
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-16">
                
                <!-- 左側 (メンタル・士気) -->
                <div class="space-y-10">
                    <!-- マネ × メンタル -->
                    <div class="animate-slide-in-left" style="animation-delay: 0.4s;">
                        <h3 id="summary-3-title" data-editable="true" class="text-2xl font-bold text-blue-300 mb-4">
                            マネジメント × メンタル・士気
                        </h3>
                        <ul id="summary-3-list" class="space-y-3 text-lg text-gray-300 pl-6 border-l-4 border-blue-500 bg-gradient-to-r from-blue-900/40 to-transparent p-4 rounded-r-lg">
                            <li id="summary-3-item-1" data-editable="true">局席・管理職と現場メンバーとの間に生じる意識・温度感のギャップ。</li>
                            <li id="summary-3-item-2" data-editable="true">「成長のための負荷」と「心理的安全性」の二項対立の発生、および両立への苦慮。</li>
                            <li id="summary-3-item-3" data-editable="true">部署長の孤立化と、管理職自身のメンタル負荷増大への懸念。</li>
                        </ul>
                    </div>
                    
                    <!-- 現場 × メンタル -->
                    <div class="animate-slide-in-left" style="animation-delay: 0.6s;">
                        <h3 id="summary-4-title" data-editable="true" class="text-2xl font-bold text-red-300 mb-4">
                            現場層 × メンタル・士気
                        </h3>
                        <ul id="summary-4-list" class="space-y-3 text-lg text-gray-300 pl-6 border-l-4 border-red-500 bg-gradient-to-r from-red-900/40 to-transparent p-4 rounded-r-lg">
                            <li id="summary-4-item-1" data-editable="true">慢性的な業務繁忙と、特定メンバーへの負荷が集中する「個への依存」構造。</li>
                            <li id="summary-4-item-2" data-editable="true">特に女性のキャリアパスに関する漠然とした不安や、ロールモデルの不足。</li>
                            <li id="summary-4-item-3" data-editable="true">チームや局としての一体感の希薄化、他部署との比較による「隣の芝生」意識。</li>
                            <li id="summary-4-item-4" data-editable="true">コンプライアンス強化等に伴う、本業以外の業務負荷の増大。</li>
                        </ul>
                    </div>
                </div>

                <!-- 右側 (スキル・成長) -->
                <div class="space-y-10">
                    <!-- マネ × スキル -->
                    <div class="animate-slide-in-right" style="animation-delay: 0.4s;">
                        <h3 id="summary-1-title" data-editable="true" class="text-2xl font-bold text-green-300 mb-4">
                            マネジメント × スキル・成長
                        </h3>
                        <ul id="summary-1-list" class="space-y-3 text-lg text-gray-300 pl-6 border-l-4 border-green-500 bg-gradient-to-r from-green-900/40 to-transparent p-4 rounded-r-lg">
                            <li id="summary-1-item-1" data-editable="true">次世代リーダー（リーダークラス・部署長候補）の育成が急務。</li>
                            <li id="summary-1-item-2" data-editable="true">キャリア入社者がリーダーシップを発揮するためのオンボーディングと育成観点の不足。</li>
                            <li id="summary-1-item-3" data-editable="true">管理職の「育成観点」の言語化と、現場での実装（再現性）の必要性。</li>
                            <li id="summary-1-item-4" data-editable="true">部署長の業務負荷が高く、マネジメント（育成）にリソースを割けない問題。</li>
                        </ul>
                    </div>

                    <!-- 現場 × スキル -->
                    <div class="animate-slide-in-right" style="animation-delay: 0.6s;">
                        <h3 id="summary-2-title" data-editable="true" class="text-2xl font-bold text-yellow-300 mb-4">
                            現場層 × スキル・成長
                        </h3>
                        <ul id="summary-2-list" class="space-y-3 text-lg text-gray-300 pl-6 border-l-4 border-yellow-500 bg-gradient-to-r from-yellow-900/40 to-transparent p-4 rounded-r-lg">
                            <li id="summary-2-item-1" data-editable="true">若手・中堅層における、具体的なキャリアビジョンやロールモデルの欠如。</li>
                            <li id="summary-2-item-2" data-editable="true">担当業務で得られるスキルの言語化（見える化）が不足しており、成長実感が持ちにくい。</li>
                            <li id="summary-2-item-3" data-editable="true">局内・局外への異動（還流）による、意図的なキャリアストレッチ機会の創出。</li>
                            <li id="summary-2-item-4" data-editable="true">評価制度と、本人が感じる成長実感や貢献度との連動性の担保。</li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- 4. フッターセクション -->
    <footer class="text-center py-8 text-gray-500 text-base">
        <p id="footer-text" data-editable="true">
            © 2025 人材開発室 - 人の成長戦略会議メンバー
        </p>
    </footer>

    <!-- 5. 編集コントロールUI -->
    <div id="edit-controls">
        <button id="edit-button" title="テキストを編集する">編集</button>
        <button id="save-button" title="変更を保存する">保存</button>
        <button id="cancel-button" title="変更をキャンセル">キャンセル</button>
        <button id="reset-button" title="保存した内容をリセット">リセット</button>
    </div>


    <!-- C. JavaScriptによる動的生成 -->
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {

            // C-1. データソース (PDFから分類・抽出)
            // 軸定義:
            // q1 (右上): マネジメント層 × スキル・成長
            // q2 (右下): 現場層 × スキル・成長
            // q3 (左上): マネジメント層 × メンタル・士気
            // q4 (左下): 現場層 × メンタル・士気
            const clusterData = {
                q1: [ // マネジメント × スキル
                    { 
                        name: "リーダークラス育成", 
                        color: "green", 
                        voices: [
                            "一番の課題はリーダークラスの育成 (植木局長 P5)",
                            "CSP異動者のトレーナーが中途で『博報堂のBDたるもの』というリードができない (植木局長 P5)",
                            "管理職が背負っている職務が大きすぎる (大村さん P26)",
                            "部署長の三重苦（ビジネス複雑さ、Z世代育成、数字） (永林補佐 P57)",
                            "マネージャー役割再定義WSの実施 (P44)",
                            "次世代リーダープロジェクトの進捗共有 (P7)",
                            "局プロジェクト (次世代リーダー育成/メディアPJ)のサポート (P38)"
                        ] 
                    },
                    {
                        name: "管理職の育成観点",
                        color: "green",
                        voices: [
                            "マネージャー支援（本人のマインドセット変更考慮） (横田補佐 P42)",
                            "管理職の期待達成度の低さ→現場の納得感ギャップ是正も必要 (片桐補佐 P87)",
                            "「○○局的リーダー」の具体化 (播田さん P93)",
                            "局内研修をやっていても、意識が低い人の壁が厚い (岡本補佐 P81)"
                        ]
                    },
                    {
                        name: "部署長サポート",
                        color: "green",
                        voices: [
                            "部署長へのヒアリング実施 (P59)",
                            "新部署長（外村部長、清水部長）へのヒアリング (宮本局長 P81, P83)"
                        ]
                    }
                ],
                q2: [ // 現場 × スキル
                    { 
                        name: "キャリアビジョン欠如", 
                        color: "yellow", 
                        voices: [
                            "キャリアに関する満足度が低かった (中島GVM P4)",
                            "文句は言うが具体的ビジョンがない社員への道筋 (中野部長 P19)",
                            "若いチームだとキャリアビジョンが描きにくい (渡辺部長 P19)",
                            "キャリアイメージが無いメンバーが多いのはショッキング (片桐補佐 P87)",
                            "スキルないけど色々やりたい（今どきの典型） (幸脇局長 P33)",
                            "10年目以降で突然変異するやつはいない (御園さん P27)",
                            "AIは引き続き改善していきます (二階さん P36)"
                        ] 
                    },
                    {
                        name: "成長機会の創出",
                        color: "yellow",
                        voices: [
                            "価値創造が重要。気づきもしないことを与える人間をどう作るか (植木局長 P5)",
                            "11局マッチング人材（自らリーダーシップをはろうとする人） (市川局長 P11)",
                            "大きいチームではクライアントを背負えないから11局に来たがる (市川局長 P12)",
                            "スキルサーベイのINPUTが毎回ゼロからで大変 (青木補佐 P101)",
                            "ハイパフォーマー分析の深化 (P117)",
                            "業務や支援による圧倒的なプロへの成長の見える化 (P83)"
                        ]
                    },
                    {
                        name: "スキル・成長の言語化",
                        color: "yellow",
                        voices: [
                            "BP職として得られるスキルを言語化することで自信が持てる (渡辺部長 P19)",
                            "15局にある仕事・スキル・成長機会の言語化 (P21)",
                            "優秀な人は忙しさの質を分析している (峯岸さん P115)"
                        ]
                    },
                    {
                        name: "異動・オンボーディング",
                        color: "yellow",
                        voices: [
                            "2局内還流、局外還流はやっていかないといけない (植木局長 P5)",
                            "CSP異動者、キャリア入社者のオンボードサポート (P7)",
                            "CSPは前部署とのギャップに不安を持つ (峯岸さん P36)",
                            "キャリア入社はかなり丁寧にしている (荒川さん P115)",
                            "CSP異動堀さん、クリエイターが活躍できる場を支援したい (中田氏 P51)"
                        ]
                    }
                ],
                q3: [ // マネジメント × メンタル
                    { 
                        name: "局席・現場ギャップ", 
                        color: "blue", 
                        voices: [
                            "局席と現場のギャップ。あって当たり前だが、解消したい (御園さん P25)",
                            "心理的安全性について、局席と現場との意識の差 (内海さん P25)",
                            "心理的安全性と成長の負荷アセスメントをやってみたい (井上補佐 P49)",
                            "どうしたら（新しいビジネスを）マインドとして出てくるのか (鏡原局長 P50)"
                        ] 
                    },
                    {
                        name: "部署長の孤立・負荷",
                        color: "blue",
                        voices: [
                            "部署長のメンタリティが心配 (根岸局長 P57)",
                            "部署長の横連携、コミュニティが減った (孤立化) (根岸局長 P57)",
                            "部署長本人のケアのためのヒアリング (P59)"
                        ]
                    },
                    {
                        name: "心理的安全性",
                        color: "blue",
                        voices: [
                            "心理的安全性が昔より高く、仕事がしやすい (中田氏 P4)",
                            "心理的な安全性の高まり、一体感の醸成が進んでいる (引田補佐 P19)"
                        ]
                    }
                ],
                q4: [ // 現場 × メンタル
                    { 
                        name: "繁忙・WLB", 
                        color: "red", 
                        voices: [
                            "下期は繁忙が予測される (坂井GVM P3)",
                            "繁忙面は数値悪化も、業務内容には満足 (荒川さん P26)",
                            "繁忙要因。そして打順を上げる&4番打者になる、の成長痛か (峯岸さん P27)",
                            "スズキチームが繁忙の中、数字が厳しい (富川補佐 P34)",
                            "コンプライアンスの強化で作業が増えている (渡邊GVM P114)",
                            "スコアはいいが、会社に来れないひとなど複数いる (村住局長 P101)",
                            "個に依存している状況 (太田補佐 P101)"
                        ] 
                    },
                    {
                        name: "キャリア不安（特に女性）",
                        color: "red",
                        voices: [
                            "気になっているのは女性のキャリア。視野が狭い (秋元補佐 P3)",
                            "女性は100%やれると思わないと引き受けない (秋元補佐 P3)",
                            "女性のキャリアビジョンへの悩みが増えている (引田補佐 P19)",
                            "女性のキャリア座談会の実施 (P7)"
                        ]
                    },
                    {
                        name: "一体感・不公平感",
                        color: "red",
                        voices: [
                            "突き抜けていくメンバーが昔に比べると少ない (中田氏 P4)",
                            "一体感やチームワークは低い (荒川さん P26)",
                            "一体感を求めていない。個々でしっかり結果を出してほしい (御園さん P26)",
                            "不公平感（評価を見せ合う環境の中で） (峯岸さん P27)",
                            "お天気アンケートで、他BD局の隣の芝生が青く見える話も多い (大村さん P26)",
                            "メディアPJで本体がきついほど隣の芝生は青く見える (富川補佐 P34)"
                        ]
                    },
                    {
                        name: "コンディション不良",
                        color: "red",
                        voices: [
                            "休職中のメンバーについては、複合的な要素 (坂井GVM P3)",
                            "日々コンディション不良はあるが概ねポジティブ (植木局長 P5)",
                            "不調者、気になるメンバーのサポート (P7)",
                            "シニアで下がってきているのは変化があるかも (大林補佐 P63)",
                            "苦しんでいる人のケアをお願い致します (嶋根補佐 P75)",
                            "ドコモチームは数字が悪く、『淡々』とやる自己防衛本能 (永林補佐 P57)"
                        ]
                    }
                ]
            };

            // C-2. パーセンテージの自動計算ロジック
            let totalVoices = 0;
            Object.values(clusterData).forEach(quadrant => {
                quadrant.forEach(cluster => {
                    totalVoices += cluster.voices.length;
                });
            });

            Object.values(clusterData).forEach(quadrant => {
                quadrant.forEach(cluster => {
                    cluster.percentage = (cluster.voices.length / totalVoices) * 100;
                });
            });

            // ヘルパー: バブルサイズ決定
            function getBubbleSize(percentage) {
                if (percentage >= 15) return 'w-40 h-40 md:w-56 md:h-56'; // 特大
                if (percentage >= 10) return 'w-32 h-32 md:w-48 md:h-48'; // 大
                if (percentage >= 5) return 'w-24 h-24 md:w-36 md:h-36'; // 中
                return 'w-20 h-20 md:w-28 md:h-28'; // 小
            }

            // ヘルパー: バブルカラー決定
            function getBubbleColors(color) {
                switch (color) {
                    case 'green':
                        return 'from-green-600 to-green-800 border-green-400';
                    case 'yellow':
                        return 'from-yellow-600 to-yellow-800 border-yellow-400';
                    case 'blue':
                        return 'from-blue-600 to-blue-800 border-blue-400';
                    case 'red':
                        return 'from-red-600 to-red-800 border-red-400';
                    default:
                        return 'from-gray-600 to-gray-800 border-gray-400';
                }
            }
            
            // ヘルパー: (発言者) をパース
            function parseVoice(voice) {
                const regex = /(.*?)(\s*\(.*?\)\s*)$/;
                const match = voice.match(regex);
                if (match) {
                    // 発言と発言者を分離
                    const mainText = match[1];
                    const speaker = match[2];
                    return `${mainText}<span class="block text-right text-gray-400 text-xs italic opacity-80 mt-1">${speaker}</span>`;
                }
                return voice; // マッチしない場合はそのまま返す
            }

            // C-3. バブルの生成 (HTML)
            function createBubbleHTML(cluster, index) {
                const sizeClass = getBubbleSize(cluster.percentage);
                const colorClasses = getBubbleColors(cluster.color);
                
                // ツールチップ内の発言リストを生成
                const voicesHTML = cluster.voices.map(voice => 
                    `<li class="border-b border-gray-700/50 py-2 last:border-b-0">${parseVoice(voice)}</li>`
                ).join('');

                return `
                    <div classs="relative group" style="animation-delay: ${1 + index * 0.1}s;">
                        <!-- バブル本体 -->
                        <div class="relative ${sizeClass} ${colorClasses} 
                                    bg-gradient-to-br border-2 rounded-full 
                                    flex items-center justify-center text-center p-2 
                                    font-bold text-white shadow-lg cursor-pointer 
                                    transition-all duration-300 ease-out 
                                    hover:scale-110 hover:shadow-2xl hover:brightness-110
                                    group-hover:ring-4 group-hover:ring-white/50 group-hover:ring-offset-2 group-hover:ring-offset-black
                                    animate-pop-in">
                            
                            <span class="text-sm md:text-base leading-tight drop-shadow-md">
                                ${cluster.name}
                                <br>
                                (${cluster.percentage.toFixed(1)}%)
                            </span>
                        </div>
                        
                        <!-- ツールチップ -->
                        <div class="tooltip invisible opacity-0 absolute bottom-full left-1/2 -translate-x-1/2 mb-2
                                    w-72 md:w-96 
                                    bg-gray-900 bg-opacity-95 backdrop-blur-md 
                                    text-gray-200 text-sm 
                                    rounded-lg shadow-xl p-4 border border-gray-700
                                    group-hover:visible group-hover:opacity-100">
                            <h4 class="font-bold text-base mb-2 border-b border-gray-600 pb-2">${cluster.name}</h4>
                            <ul class="space-y-1 text-left list-none m-0 p-0 max-h-[300px] overflow-y-auto">
                                ${voicesHTML}
                            </ul>
                            <div class="absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0
                                        border-l-[10px] border-l-transparent
                                        border-r-[10px] border-r-transparent
                                        border-t-[10px] border-t-gray-900/95">
                            </div>
                        </div>
                    </div>
                `;
            }

            // C-4. 描画ロジック
            const quadrants = [
                { id: 'quadrant-1', data: clusterData.q1 },
                { id: 'quadrant-2', data: clusterData.q2 },
                { id: 'quadrant-3', data: clusterData.q3 },
                { id: 'quadrant-4', data: clusterData.q4 },
            ];

            quadrants.forEach(q => {
                const pcContainer = document.getElementById(q.id);
                const mobileContainer = document.getElementById(`${q.id}-mobile`);
                let htmlContent = '';
                
                // データをパーセンテージで降順ソート
                const sortedData = [...q.data].sort((a, b) => b.percentage - a.percentage);
                
                sortedData.forEach((cluster, index) => {
                    htmlContent += createBubbleHTML(cluster, index);
                });

                if (pcContainer) pcContainer.innerHTML = htmlContent;
                if (mobileContainer) mobileContainer.innerHTML = htmlContent;
            });


            // C-5. 編集機能とLocalStorageのロジック
            const storageKey = 'editableContent_growthStrategyMapD2';
            const editableElements = document.querySelectorAll('[data-editable="true"]');
            const editButton = document.getElementById('edit-button');
            const saveButton = document.getElementById('save-button');
            const cancelButton = document.getElementById('cancel-button');
            const resetButton = document.getElementById('reset-button');
            
            let originalContent = {};
            let isEditing = false;

            // 1. 保存内容の読み込み
            function loadContent() {
                try {
                    const savedData = localStorage.getItem(storageKey);
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        editableElements.forEach(el => {
                            if (data[el.id]) {
                                if (el.id === 'page-title') {
                                    document.title = data[el.id];
                                } else {
                                    el.innerHTML = data[el.id];
                                }
                            }
                        });
                        if (data['page-title']) {
                             document.title = data['page-title'];
                        }
                    }
                } catch (error) {
                    console.error("Failed to load content from localStorage:", error);
                    localStorage.removeItem(storageKey); // 破損したデータを削除
                }
            }

            // 編集モード終了（共通処理）
            function endEditing() {
                isEditing = false;
                editableElements.forEach(el => {
                    if (el.id !== 'page-title') {
                        el.contentEditable = 'false';
                    }
                });
                editButton.style.display = 'inline-block';
                resetButton.style.display = 'inline-block';
                saveButton.style.display = 'none';
                cancelButton.style.display = 'none';
            }

            // 2. 編集開始
            function startEditing() {
                isEditing = true;
                originalContent = {}; // 退避用オブジェクトを初期化
                
                editableElements.forEach(el => {
                    if (el.id === 'page-title') {
                        originalContent[el.id] = document.title;
                    } else {
                        originalContent[el.id] = el.innerHTML;
                        el.contentEditable = 'true';
                    }
                });

                editButton.style.display = 'none';
                resetButton.style.display = 'none';
                saveButton.style.display = 'inline-block';
                cancelButton.style.display = 'inline-block';
            }

            // 3. 保存処理
            function saveContent() {
                try {
                    // 新しいページタイトルをpromptで取得
                    const newPageTitle = prompt("新しいページタイトルを入力してください:", document.title);
                    if (newPageTitle !== null && newPageTitle.trim() !== "") {
                        document.title = newPageTitle.trim();
                    }

                    const dataToSave = {};
                    editableElements.forEach(el => {
                        if (el.id === 'page-title') {
                            dataToSave[el.id] = document.title; // 更新されたタイトルを保存
                        } else {
                            dataToSave[el.id] = el.innerHTML;
                        }
                    });

                    localStorage.setItem(storageKey, JSON.stringify(dataToSave));
                    endEditing();
                    // alert("保存しました。"); // alertの代わりにコンソールログ
                    console.log("Content saved to localStorage.");
                } catch (error) {
                    console.error("Failed to save content to localStorage:", error);
                    // alert("保存に失敗しました。");
                }
            }

            // 4. キャンセル処理
            function cancelEditing() {
                // 退避させた内容に戻す
                editableElements.forEach(el => {
                    if (originalContent[el.id]) {
                        if (el.id === 'page-title') {
                            document.title = originalContent[el.id];
                        } else {
                            el.innerHTML = originalContent[el.id];
                        }
                    }
                });
                endEditing();
            }
            
            // 5. リセット処理
            function resetContent() {
                // confirmの代わりにカスタムUIを推奨しますが、要件通りconfirmを使用
                if (confirm("保存されたすべての変更をリセットし、ページをリロードします。よろしいですか？")) {
                    try {
                        localStorage.removeItem(storageKey);
                        location.reload();
                    } catch (error) {
                        console.error("Failed to reset content:", error);
                        // alert("リセットに失敗しました。");
                    }
                }
            }

            // イベントリスナーの設定
            editButton.addEventListener('click', startEditing);
            saveButton.addEventListener('click', saveContent);
            cancelButton.addEventListener('click', cancelEditing);
            resetButton.addEventListener('click', resetContent);

            // 初期読み込み
            loadContent();

        });
    </script>

</body>
</html>
