<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>部門別 平均利用回数</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Interフォントの読み込み */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">
    <div class="container mx-auto max-w-6xl">
        <div class="bg-white rounded-lg shadow-xl p-6 md:p-8">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">
                部門別 平均利用回数
            </h1>
            <p class="text-center text-gray-600 mb-8">
                提供されたデータに基づき、主要部門ごとの平均利用回数を算出しました。
            </p>
            <div class="w-full h-96 md:h-[500px]">
                <canvas id="usageChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // 提供された元データ
        const rawData = `name	操作数
西野 慶史郎 博報堂 出経企	898
児玉 捷平 博報堂 出マケ推 出マ企２	888
荻野 綱重 ＨＭＣ 旧ＭＰ人	308
井上 玲子 ＨＭＣ メ事経室 メ計管一	243
仙石 大記 博報堂 出経企 出経企Ｇ	241
岸田 泰幸 博報堂 出事投推	236
後 皓介 ＨＭＣ 旧ＭＰ人	233
小國 美紗子 ＣＩ ＣＩ総務 総務情報	198
竹内 雄哉 ＨＭＣ 統合ＡＰ 東京ｉメ	192
岸本 顕吾 博報堂 出ＣＤＸ 出ＣＤ戦	181
森 隆文 Ｈテクノ マケＤＸ マケ３部	157
有村 真実子 ＨＣ ＲＤ室 ＲＤ企推	151
木下 陽介 博報堂 人事室 Ｈテク出	149
本橋 尭大 博報堂 人事室 Ｈテク出	144
ソン ミンジェ 博報堂 人事室 Ｈテク出	136
松本 拓也 ＨＭＣ ＰＦ戦略 ＰＦソリ	131
藤井 龍 ＨＭＣ ＰＦ戦略 ＰＦ一部	121
片岸 正雄 ＨＭＣ メサ開発 デジ開部	120
上田 晋司 博報堂 出Ｃ経営 出Ｃ戦略	116
滝澤 輝久 博報堂 人事室 Ｈテク出	116
齋藤 香莉菜 博報堂 人事室 Ｈテク出	115
長瀬 久在 博報堂 人事室 Ｈテク出	101
猪上 学 博報堂 出総務 出総務情	99
尾澤 暁 博報堂 出総務 出総務情	97
濵口 京之介 博報堂 人事室 Ｈテク出	94
三橋 可奈 博報堂 人事室 Ｈテク出	93
田路 崇人 博報堂 出経企 出経企経	92
河合 和彦 博報堂 出秘室	86
小林 翼 博報堂 人材開発 人開留学	86
木脇 亮明 ＯＮＥ	84
竹村 剛一良 博報堂 人事室 Ｈテク出	84
河合 正浩 博報堂 出ビジコ 出コスマ	83
井川 浩輔 博報堂 人事室 Ｈテク出	71
田中 美奈子 博報堂 ビジ推進 ビジ推生	69
江口 嘉成 博報堂 人事室 Ｈテク出	68
酒井 照光 博報堂 出ビジコ 出コスマ	64
川本 晃大 博報堂 人事室 Ｈテク出	62
黒木 開 Ｈテクノ マケ事推 マ開４部	61
安藤 喜元 博報堂 出ビジコ 出協力マ	58
金 基善 博報堂 人事室 Ｈテク出	57
髙木 雄司 博報堂 人事室 Ｈテク出	54
田中 晃生 ＨＭＣ ビジコ 発マＧ	54
頴川 明弘 ＣＩ ビジコン コスマネ	54
佐々木 奈都妃 Ｈテクノ 開発第１ 開１ＳＢ	51
矢吹 侑子 博報堂 出法務 出第一法	50
津田 正志 博報堂 出ビジコ 出発注マ	47
西本 凌也 博報堂 出法務 出第二法	46
服部 雄大 博報堂 第六ＢＤ 六局四Ａ	45
中島 拓幹 博報堂 出経財 出二主計	44
金井 亮雅 博報堂 ＣＸＣ局 ＣＸ＆サ	41
宮本 摩紀 ＯＮＥ	41
西川 優 ＨＭＣ 旧ＭＰ人	39
森崎 幹也 Ｈテクノ メデ事推 開推３部	38
荒川 有輝 博報堂 事業経画 Ｂ事人マ	37
岩下 航 博報堂 ビジ推進 ビジ推生	36
西森 菜央 博報堂 出人事室 出ＴＡ部	36
高橋 真理子 博報堂 出総務 出総務オ	34
大﨑 翔平 博報堂 人事室 Ｈテク出	34
上村 紗世 博報堂 第六ＢＤ 六局四Ａ	33
田縁 美幸 博報堂 プラサ門 プラサポ	32
中嶋 克臣 博報堂 人事室 Ｈテク出	32
宗像 伸欣 博報堂 出総務 出総務オ	32
久保 和也 博報堂 出ビジコ 出コスマ	32
松尾 大志 Ｈテクノ メデ事推 開推３部	31
森下 明 博報堂 ＧＰ局 ＧＰＧ三	31
立石 雄太 博報堂 第八ＢＤ 八局一Ａ	31
横山 智彦 博報堂 第三ＢＤ 三局一Ａ	30
酒巻 恵美 博報堂 アカ統括 ア統業推	30
清水 雄太 ＯＮＥ	29
所 洋介 博報堂 事経企室 事経人二	29
馬場 宏之 博報堂 プラサ門 プラサポ	28
二階 晋平 博報堂 出人開室 出人開成	28
深野 安摩音 ＯＮＥ	28
坂田 将基 ＯＮＥ	27
中村 有陛 博報堂 統メディ 統メデ二	27
永井 直樹 博報堂 第六ＢＤ 六局四Ａ	27
村田 慎二 Ｈテクノ マケ事推 マ開４部	26
村田 彩 博報堂 人事室 Ｈテク出	26
澤田 航平 博報堂 ＳＴＰ局 ＳＴ藤井	26
平塚 祥 博報堂 アカ統括 ア統総管	25
山内 良哉 博報堂 出Ｃ経営 出Ｃ戦略	25
尾崎 遼太郎 Ｈテクノ 開発第１ 開１ＳＢ	25
多田 宜広 博報堂 ＣＵＰ局 ＣＵＰプ	25
塩屋 かすみ ＯＮＥ	24
内ヶ崎 由佳 博報堂 プラサ門 プラサポ	24
山下 敬太 ＨＤＹＶ ＨＶ営門 ＨＶ営署	24
松井 慶 博報堂 ビジ推進 ビジ推Ｂ	24
稲井 祐介 博報堂 ＳＴＰ局 ＳＴ中平	24
松井 一哲 博報堂 出ＣＤＸ 出ＣＤ企	23
川西 由加里 博報堂 出ＲＤ 出ＲＤ管	22
松倉 俊光 ＣＩ ＣＩ法務 法務戦略	22
垣屋 有葉 博報堂 人事室 Ｈテク出	22
大久保 重伸 博報堂 事経企室	22
堀内 誠 博報堂 出ビジコ 出コスマ	22
宮原 卓 博報堂 ビジ推進 ビジ推生	21
津留﨑 佳乃 ＯＮＥ	21
髙橋 はな 博報堂 統メディ 統メデ一	20
高木 康晃 博報堂 ＣＵＰ局	20
國原 麻美 博報堂 出ビジコ 出コスマ	20
大津 暁奈 博報堂 出Ｃ経営 出Ｃ戦総	20
今村 祐太 博報堂 出経財 出二主計	20
松本 咲葵 博報堂 ＧＰ局 ＧＰＧ一	20
松﨑 健 博報堂 人事室 Ｈテク出	19
北山 昌希 Ｈテクノ メデ事推 ＤＴ２部	19
平山 幸伸 Ｈテクノ メデ事推 開推３部	19
内田 嘉乃 博報堂 出秘室 出秘部	19
平子 宣明 博報堂 出人事室 出ＨＲ部	19
佐藤 新 博報堂 出ＲＤ 出ＲＤ企	19
板垣 徹 博報堂 出ビジコ 出コスマ	18
坂本 佐保 博報堂 出ビジコ 出発注マ	18
樋口 友子 博報堂 出ビジコ 出協力マ	18
本吉 秀輝 博報堂 統メディ 統メデ一	18
小澤 一穂 博報堂 人事室 Ｈテク出	18
細野 百子 博報堂 事経企室 事経人二	18
竹中 万丈 ＯＮＥ	17
佐藤 瞭介 博報堂 統メディ 統メデ二	17
石井 雄大 博報堂 ＧＰ局 ＧＰＧ一	17
鈴木 健太 ＣＩ ビジコン コスマネ	17
磯部 康人 博報堂 出ビジコ 出コスマ	16
髙谷 詩帆 ＯＮＥ	16
三浦 慎平 博報堂 出ＭＴＣ 出Ｍ開１	16
増田 カヨ子 博報堂 出ビジコ 出協力マ	16
麻生 准 ＣＩ ＣＩ法務 グロ法務	16
山本 奨 博報堂 ＳＴＰ局 ＳＴ休出	16
松田 七海 博報堂 出法務 出第二法	16
吉田 大 博報堂 ＳＴＰ局 ＳＴ吉田	16
柳下 みなみ ＯＮＥ	15
星野 智紀 Ｈテクノ メデ事推 ＤＴ２部	15
池本 敦美 ＯＮＥ	15
佐野 慎一郎 博報堂 第六ＢＤ 六局四Ａ	15
大久保 湧太 Ｈテクノ ＶＣｃセ ＶＣｃ３	15
上村 隆章 博報堂 出ビジコ 出建築業	15
桑原 里奈 博報堂 統メディ 統メデ二	15
岡本 哲宗 博報堂 第八ＢＤ	14
小池 瑞穂 Ｈテクノ マケ事推 マ開４部	14
戸部 大嗣 ＨＭＣ 旧ＭＰ人	14
牧野 壮平 博報堂 第六ＢＤ 六局四Ａ	14
早川 俊之 ＨＭＣ ビジコ 発マＧ	14
下濵 拓哉 読広 総務局 Ｃマネ部	14
佐藤 尚弘 博報堂 人事室 Ｈテク出	14
木下 愛 博報堂 出Ｃ経営 出Ｃ戦総	13
康 勝行 博報堂 統メディ 統メデ二	13
津村 重也 ＨＭＣ ビジコ 発マＧ	13
近藤 綾 博報堂 ＧＰ局 ＧＰＧ二	13
甲斐 智博 Ｈテクノ メデ事推 開推３部	13
児島 健太郎 ＨＭＣ 旧ＭＰ人	13
伊藤 暢康 博報堂 人事室 Ｈテク出	13
内山 稜太 ＨＭＣ 旧ＭＰ人	13
河野 瑞樹 Ｈテクノ 開発第１ 開１ＳＢ	13
岡部 裕介 博報堂 事経企室 事経人二	12
氏家 音絵 Ｈテクノ メデ事推 ソリ開発	12
田中 裕基 ＯＮＥ	12
山﨑 康史 ＨＭＣ ビジコ 発マＧ	12
栢野 達也 博報堂 出ビジコ 出コスマ	12
浅見 正洋 Ｈテクノ メデ事推 ＤＴ２部	12
生田 京子 博報堂 出ＣＤＸ 出ＣＤ戦	12
高口 智成 Ｈテクノ 開発第１ 開１ＳＢ	12
横山 徹 ＣＩ ビジコン コスマネ	12
中野 真 ＣＩ ビジコン コスマネ	12
齋藤 真由 博報堂 ＳＴＰ局 ＳＴ齋藤	12
吉川 哲司 博報堂 統メディ 統メデ三	12
川上 孝介 Ｈテクノ メデ事推 ＤＴ２部	11
濱下 集平 博報堂 ＳＴＰ局 ＳＴ藤井	11
鈴木 ひろ子 博報堂 アカ統括 ア統総管	11
河野 裕武 博報堂 ＳＴＰ局 ＳＴ事二	11
岡﨑 里桜 博報堂 ＳＴＰ局 ＳＴ石井	11
二村 翼 ＯＮＥ ＴＸマ開 ２部	11
石川 康之 博報堂 出総務 出総務オ	11
河口 幸生 博報堂 出ビジコ 出発注マ	11
村井 京香 博報堂 ＳＴＰ局 ＳＴ石井	11
早川 直輝 博報堂 人事室 Ｈテク出	10
森本 拓郎 博報堂 ビジ推進	10
大久保 佳蓮 読広 総務局 Ｃマネ部	10
前田 亜紀 博報堂 第三ＢＤ 三局一Ａ	10
古澤 直木 博報堂 出秘室	10
周 嘉晟(Jay_Zhou) 博報堂 ＳＴＰ局 ＳＴＧプ	10
出雲 大 博報堂 ＳＴＰ局 ＳＴ小田	10
駿河 茂彦 ＨＭＣ ビジコ 発マＧ	9
西股 貴宏 博報堂 出ビジコ	9
向井 裕輝 博報堂 人事室 Ｈテク出	9
木塚 聡 博報堂 出ビジコ 出コスマ	9
福島 碧唯 Ｈテクノ メデ事推 開推３部	9
和田 訓一 博報堂 第八ＢＤ 八局二Ａ	9
吉田 博子 博報堂 出ビジコ 出コスマ	9
渡邉 大和 博報堂 ＳＴＰ局	9
中平 充 博報堂 ＳＴＰ局 ＳＴ中平	9
矢島 さえ 博報堂 出ビジコ 出発注マ	9
岩田 千安紀 博報堂 出Ｃ経営 出Ｃ戦総	9
佐原 利周 博報堂 統メディ 統メデ三	9
近藤 雄太郎 Ｈテクノ メデ事推 開推２部	8
上野 仁志 博報堂 出ビジコ 出コスマ	8
花澤 徹也 博報堂 出ビジコ 出コスマ	8
佐治木 のぞみ 博報堂 出Ｃ経営	8
佐野 智佳 博報堂 第三ＢＤ 三局一Ａ	8
湯淺 英太郎 博報堂 事経企室 事経人二	8
淵辺 穣 博報堂 出ビジコ	8
橋本 浩利 ＨＭＣ ＭＢ基盤 開発推一	8
佐藤 哲至 ＨＭＣ 旧ＭＰ人	8
目黒 智也 博報堂 統メディ 統メデ二	8
須藤 美羽 博報堂 統メディ 統メデ二	8
徳丸 未峻 博報堂 統メディ 統メデ一	8
小池 健人 博報堂 ＳＴＰ局	8
吉岡 亮磨 博報堂 ＳＴＰ局 ＳＴ古庄	8
石川 碧水 博報堂 第六ＢＤ 六局四Ａ	8
武村 絵里 博報堂 ビジ推進 ビジ推生	8
山岡 小百合 博報堂 ＳＴＰ局 ＳＴ齋藤	8
三宅 達也 博報堂 出法務 出ＣＲコ	7
小野 万優子 博報堂 統メディ 統メデ三	7
石丸 信 博報堂 出法務 出第一法	7
三井 惠理 博報堂 十四ＢＤ 十四局四	7
池田 真菜 博報堂 第三ＢＤ 三局一Ａ	7
水上 裕貴 博報堂 中部ＢＤ 中部統プ	7
西巻 佳祐 博報堂 ＭＢ基盤 開発推一	7
麻生 裕樹 博報堂 ＧＰ局 ＧＰＧ三	7
藤本 月穂 博報堂 ＳＴＰ局 ＳＴ事二	7
後藤 侃 ＯＮＥ 広テク企 ＡｄＯｐ	7
関川 淳 博報堂 出ビジコ	7
外村 直紀 博報堂 第八ＢＤ 八局一Ａ	7
細野 健人 Ｈテクノ メデ事推 ＤＴ２部	7
守屋 惇史 博報堂 出法務 出第二法	7
伊藤 慶紀 Ｈテクノ ＣＤＸ ＢＰ３部	7
渡邉 真奈美 ＨＣ ＨＣ経企 経企組織	6
寺東 久美子 博報堂 人事室 Ｈテク出	6
宮田 賢 博報堂 出ビジコ 出コスマ	6
横倉 真由美 ＨＣ ＨＣ法務	6
羽田 陽哉 博報堂 ＳＴＰ局 ＳＴ保田	6
廣本 嶺 ＨＭＣ 旧ＭＰ人	6
西田 楽太 ＨＭＣ 旧ＭＰ人	6
城間 拓也 博報堂 ＧＰ局 ＧＰＧ一	6
隅田 順 博報堂 ＳＴＰ局	6
髙橋 祐二 博報堂 人事室 Ｈテク出	6
大場 隆広 Ｈテクノ メデ事推 開推３部	6
荒木 裕次 Ｈテクノ メデ事推 開推２部	6
林 竜太郎 博報堂 ＧＰ局 ＧＰＧ一	6
武藤 真 博報堂 第八ＢＤ 八局一Ａ	6
蔵下 陸 博報堂 ＧＰ局 ＧＰＧ二	5
栃原 修 博報堂 第八ＢＤ 八局一Ａ	5
福地 亮 ＨＭＣ 旧ＭＰ人	5
横野 正憲 博報堂 出ビジコ 出コスマ	5
平間 遥絵 博報堂 第八ＢＤ 八局五Ａ	5
長田 由里 ＨＣ ＨＣ経企 経企経計	5
ジェイムス ブルース 博報堂	5
池田 有那 博報堂 統メディ 統メデ一	5
大倉 悠介 博報堂 統メディ 統メデ一	5
井上 宏之 博報堂 出広報	5
池上 直子 ＨＣ ＨＣ人開 人開旧成	5
河合 双葉 博報堂 第六ＢＤ 六局四Ａ	5
河波 正樹 博報堂 第三ＢＤ 三局一Ａ	5
赤堀 真平 博報堂 第八ＢＤ 八局一Ａ	5
グェンヴァン ラム Ｈテクノ メデ事推 開推３部	5
山口 公男 博報堂 出事推 出事企	5
江口 省悟 ＨＭＣ 旧ＭＰ人	5
北見 紗英 Ｈテクノ メデ事推 ソリ開発	5
関口 比名子 博報堂 出ビジコ 出協力マ	4
長野 歌穂 博報堂 ＳＴＰ局 ＳＴ吉田	4
永松 英恵 博報堂 ＧＰ局 ＧＰＧ二	4
増井 佑亮 博報堂 人事室 Ｈテク出	4
豊田 昂 博報堂 ＳＴＰ局	4
山下 梓 博報堂 ＳＴＰ局 ＳＴ西垣	4
熊谷 翔 ＯＮＥ	4
小石 雄介 博報堂 統メディ 統メデ三	4
山本 洋平 博報堂 ＳＴＰ局 ＳＴ山本	4
豆谷 浩輝 博報堂 人事室 Ｈテク出	4
佐久間 英彰 博報堂 出ビジコ 出コスマ	4
ニン ゲツ(yue_ren) 博報堂 ＳＴＰ局 ＳＴＧプ	4
岡田 康佑 博報堂 ＧＰ局 ＧＰＧ三	4
宮坂 楓菜 博報堂 第八ＢＤ 八局一Ａ	4
加納 隆伸 ＨＭＣ 旧ＭＰ人	4
西 和哉 Ｈテクノ テク戦 戦略企画	4
諏訪 めぐみ ＯＮＥ ＣＤＢＰ １計画部	4
堀川 良且 博報堂 出総務 出総務オ	4
片山 寛知 博報堂 統メディ 統メデ二	4
上村 聡 博報堂 出総務 出総務コ	4
佐久間 翔士 博報堂 ＧＰ局 ＧＰＧ一	4
横山 陽史 博報堂 ＭＳＣ局	4
引地 瞭 読広 ＩＣＣ 櫻井Ｒ	4
南部 亜紀 博報堂 ＳＴＰ局 ＳＴ小田	4
王 直 Ｈテクノ メデ事推 ＤＴ２部	4
柳澤 博之 博報堂 出ビジコ 出建築業	4
倉岡 将厳 博報堂 出総務 出総務コ	4
宮崎 聖 博報堂 ＭＢ基盤 開発推一	4
藤田 明優菜 博報堂 ＧＰ局 ＧＰＧ二	4
村田 博彰 博報堂 事経企室 事経人二	4
平野 尚志 博報堂 出法務 出グロ法	4
山下 茉莉奈 博報堂 出ビジコ 出コンプ	4
藤本 良信 ＨＭＣ 旧ＭＰ人	4
波田 桂治郎 博報堂 出法務 出ＣＲコ	4
礒西 陽子 博報堂 出ビジコ 出コスマ	4
入江 友子 ＣＩ ＣＩ法務 法務戦略	4
林 匠太郎 博報堂 ＧＰ局 ＧＰＧ一	4
磯野 昇 博報堂 出ビジコ 出建築業	3
浦井 悠史 博報堂 出総務 出総務コ	3
下元 彩椰 博報堂 統メディ 統メデ三	3
別所 優斗 博報堂 ＧＰ局 ＧＰＧ一	3
酒井 理佐 ＯＮＥ	3
渡辺 泰輔 博報堂 第八ＢＤ 八局四Ａ	3
白坂 咲々良 博報堂 ＧＰ局 ＧＰＧ二	3
近藤 愛華 博報堂 ＳＴＰ局 ＳＴ佐藤	3
藤本 政恭 博報堂 出法務 出ＣＲコ	3
鈴木 公大 博報堂 出人事室 出計画部	3
松谷 拓哉 博報堂 ＳＴＰ局	3
奥田 悠太 Ｈテクノ メデ事推 ＤＴ２部	3
山岡 智行 博報堂 ＳＴＰ局 ＳＴ江藤	3
北川 雄一朗 博報堂 人事室 Ｈテク出	3
鷲田 洋子 ＨＣ コンプラ	3
中世古 真吾 Ｈテクノ メデ事推 ＤＴ２部	3
髙橋 怜杏 博報堂 人事室 Ｈテク出	3
佐藤 素子 博報堂 人事室 Ｈテク出	3
町田 宙己 博報堂 ＧＰ局 ＧＰＧ二	3
馬島 久直 博報堂 ＧＰ局 ＧＰＧ一	3
髙橋 千尋 ＨＭＣ ＡＢ戦局 ＡＢ戦五	3
東條 公彰 博報堂 出法務	3
八乙女 ゆい 博報堂 統メディ 統メデ一	3
真継 大輝 Ｈテクノ 開発第３ Ａｄ１部	3
坂田 由紀子 博報堂 出Ｃ経営 出Ｃ戦総	3
石塚 湖太 Ｈテクノ メデ事推 ＤＴ２部	3
神谷 一孝 博報堂 ＣＲ局	3
平山 はな 博報堂 ＳＴＰ局 ＳＴ藤井	2
木村 大作 博報堂 事経企室	2
曽我 大晴 博報堂 ＳＴＰ局 ＳＴ齋藤	2
小池 光洋 博報堂 出ビジコ 出コスマ	2
橋本 昌也 博報堂 ＳＴＰ局 ＳＴ石井	2
中川 愛理(Airi Nakagawa) 博報堂 ＳＴＰ局 ＳＴ佐藤	2
本田 采那 博報堂 ＳＴＰ局 ＳＴ齋藤	2
清水 春彦 博報堂 出ビジコ 出建築業	2
佐々木 竜太郎 博報堂 ＳTＰ局 ＳＴ江藤	2
柴生田 五月 博報堂 アカ統括 ア統総管	2
小林 明子 博報堂 経営企画 経企ＷＳ	2
西田 一貴 博報堂 ＧＰ局 ＧＰＧ二	2
池田 将之 博報堂 ＳＴＰ局 ＳＴ石井	2
中村 信 博報堂	2
藤井 隆 博報堂 第八ＢＤ 八局五Ａ	2
石丸 知佐 Ｈテクノ マネＣ 管理三部	2
大橋 勇太 博報堂 出経企 出経企事	2
鈴木 寛人 Ｈテクノ マケ事推 マ開４部	2
吉田 英一郎 ＨＣ ＨＣ経企	2
岩根 昂平 Ｈテクノ 開発第３ Ａｄ２部	2
大迫 佐江 博報堂 出人事室	2
塚田 郁実 博報堂 出広報 出広一広	2
由利 啓祐 博報堂 ＳＴＰ局 ＳＴ江藤	2
藤本 大祐 博報堂 出ビジコ 出コスマ	2
安保 鉄也 博報堂 出人事室	2
森田 光洋 博報堂 第八ＢＤ 八局一Ａ	2
田中 侑李 博報堂 ＧＰ局 ＧＰＧ三	2
児玉 理紗 博報堂 ＳＴＰ局 ＳＴ齋藤	2
藤江 宏紀 博報堂 ＳＴＰ局 ＳＴ石井	2
浅田 正寛 博報堂 出人事室 出ＴＡ部	2
日渡 早映 ＯＮＥ 広テク企 ＡｄＯｐ	2
黒住 奈生 博報堂 ＳＴＰ局 ＳＴ事一	2
山口 悟子 博報堂 出ビジコ 出コスマ	2
松村 和 博報堂 ＳＴＰ局 ＳＴ西垣	2
滝澤 大輝 Ｈテクノ テク戦 戦略企画	2
佐野 優花 ＨＭＣ 旧ＭＰ人	2
岐津 俊輔 ＨＭＣ 旧ＭＰ人	2
柳原 康成 ＨＣ ＨＣ法務	2
田中 伸明 博報堂 出ビジコ 出コスマ	2
林 裕真 博報堂 ＧＰ局 ＧＰＧ二	2
北島 麻衣 博報堂 第八ＢＤ 八局一Ａ	1
木谷 俊祐 博報堂 ＤＡＭ室	1
濵 隆雄 博報堂 出ビジコ 出協力マ	1
宇津見 燦 ＯＮＥ ＴＸ推進 ナレマネ	1
小泉 拓郎 ＨＭＣ 旧ＭＰ人	1
虫明 聡美 博報堂 出総務 出総務オ	1
妹尾 英俊 博報堂 第八ＢＤ 八局一Ａ	1
高松 美香 博報堂 出法務 出ＣＲコ	1
増田 浩 ＨＣ ＨＣ法務 法務第一	1
村上 紀超 Ｈテクノ マケ事推 マ開４部	1
大河原 陸 博報堂 第八ＢＤ 八局四Ａ	1
山内 全逸(Hirohaya_Joshua_Yamauchi) 博報堂 ＳＴＰ局 ＳＴＧプ	1
藤本 和 Ｈテクノ マケ事推 マ開４部	1
中澤 壮吉 博報堂 統メディ	1
吉村 尚人 博報堂 出法務 出ＣＲコ	1
郭 昊 Ｈテクノ メデ事推 開推３部	1
宮澤 良和 博報堂 人事室 Ｈテク出	1
濵野 寛子 博報堂 第三ＢＤ 三局一Ａ	1
佐々井 美嘉 博報堂 統メディ 統メデ一	1
中村 力也 博報堂 第八ＢＤ 八局二Ａ	1
岩佐 篤 ＯＮＥ	1
足立 光弘 博報堂 第三ＢＤ 三局一Ａ	1
横山 貴星 博報堂 ＳＴＰ局 ＳＴ中平	1
児玉 壮平 Ｈテクノ メデ事推 ＤＴ２部	1
廣中 凌平 博報堂 ＳＴＰ局 ＳＴ石井	1
小川 楽 博報堂 人事室 Ｈテク出	1
石川 智雄 博報堂 出経財 出二主計	1
川添 伸二 ＨＣ ＨＣ総務 総務オフ	1
尾形 郁俊(IkuToshi_Ogata) 博報堂 ＳＴＰ局 ＳＴＧプ	1
鈴木 幸絵 Ｈテクノ メデ事推 ＵＳ部	1
李 彩銀 博報堂 統メディ 統メデ二	1
宿野 弘明 博報堂 ＳＴＰ局 ＳＴ江藤	1
加藤 陽平 博報堂 人事室 Ｈテク出	1
渋井 理 博報堂 ＧＰ局 ＧＰＧ一	1
山崎 泰央 博報堂 出ビジコ 出建築業	1
恩地 文夫 博報堂 ＤＡＭ室 ＤＡＭ二	1
大西 賢一郎 博報堂 第六ＢＤ 六局四Ａ	1
土屋 浩之 博報堂 出ビジコ 出コスマ	1
宮久 流維 博報堂 ＳＴＰ局	1
田中 祐子 博報堂 第六ＢＤ 六局四Ａ	1
フォラン ジョセフ Ｈテクノ メデ事推 ＤＴ２部	1
垰田 昌宏 Ｈテクノ メデ事推 開推１部	1
磯田 知輝 博報堂 統メディ 統メデ一	1
石原 拓実 博報堂 ＳＴＰ局 ＳＴ吉田	1
高柳 広夢 博報堂 第八ＢＤ 八局二Ａ	1
安藤 博康 博報堂 出ビジコ 出コスマ	1
髙木 滉紀 ＯＮＥ ＴＸデ開 ２部	1
定方 もも 博報堂 第八ＢＤ 八局二Ａ	1
髙橋 潤 博報堂 人事室 Ｈテク出	1
阿部 友花 博報堂 第六ＢＤ 六局四Ａ	1
芦名 博史 博報堂 ＳＴＰ局 ＳＴ齋藤	1
長通 佑也 博報堂 出経企 出経企経	1
田中 雄介 博報堂 出総務	1
鈴木 健太 ＨＭＣ 旧ＭＰ人	1
羽原 要 博報堂 ＧＰ局 ＧＰＧ三	1
長谷川 維臣 ＯＮＥ ＴＸマ開 ２部	1
坂田 玲実 博報堂 出法務 出グロ法	1
平井 小百合 博報堂 出法務 出ＣＲコ	1
牛尾 宜弘 ＨＭＣ 旧ＭＰ人	1
山崎 大介 博報堂 ＧＰ局	1
下川 隆吾 博報堂 ＳＴＰ局	1
浅野 翔 博報堂 統メディ 統メデ三	1
湯淺 康平 博報堂 ＳＴＰ局 ＳＴ吉田	1
三ツ井 菜菜子 博報堂 ＧＰ局 ＧＰＧ二	1
奥田 瑛梨奈 Ｈテクノ メデ事推 開推２部	1
為谷 巧 博報堂 統メディ 統メデ一	1
粂川 未来 博報堂 出人事室 出計画部	1
竹村 陸 ＨＭＣ 旧ＭＰ人	1
宮下 里彩 博報堂 統合ＡＰ 統ＡＡ推	1
春本 理沙 博報堂 ＧＰ局 ＧＰＧ一	1`;

        // データの集計とグラフ描画
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const stats = parseData(rawData);
                drawChart(stats);
            } catch (error) {
                console.error("グラフの描画に失敗しました:", error);
                const canvas = document.getElementById('usageChart');
                const ctx = canvas.getContext('2d');
                ctx.font = '20px Inter';
                ctx.fillStyle = 'red';
                ctx.textAlign = 'center';
                ctx.fillText('データの処理中にエラーが発生しました。', canvas.width / 2, canvas.height / 2);
            }
        });

        /**
         * データをパースして部門別に集計する
         * @param {string} dataString - 元のテキストデータ
         * @returns {object} - 集計結果
         */
        function parseData(dataString) {
            const lines = dataString.trim().split('\n');
            const stats = {};
            const departments = ["博報堂", "ＨＭＣ", "ＣＩ", "Ｈテクノ", "ＨＣ", "ＯＮＥ", "読広", "ＨＤＹＶ"];

            // ヘッダー行をスキップ
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const parts = line.split('\t');
                if (parts.length < 2) continue;

                const nameCol = parts[0];
                const valueStr = parts[1];
                const value = parseInt(valueStr, 10);

                if (isNaN(value)) continue;

                let dept = null;
                const nameParts = nameCol.split(' ');
                let personNameParts = [];
                
                // 部門名を特定し、それより前の部分を氏名として抽出
                for (const part of nameParts) {
                    if (departments.includes(part)) {
                        dept = part;
                        break;
                    }
                    personNameParts.push(part);
                }
                
                // 上記ロジックで部門名が見つからなかった場合のフォールバック
                if (!dept) {
                    for (const d of departments) {
                        if (nameCol.includes(d)) {
                            dept = d;
                            break;
                        }
                    }
                }

                if (dept) {
                    if (!stats[dept]) {
                        stats[dept] = { total: 0, count: 0, members: [] }; // members配列を追加
                    }
                    stats[dept].total += value;
                    stats[dept].count += 1;

                    // 氏名を抽出
                    const displayName = personNameParts.length > 0 ? personNameParts.join(' ') : nameCol; // フォールバック
                    stats[dept].members.push({ name: displayName, value: value });
                }
            }
            return stats;
        }

        /**
         * Chart.js を使ってグラフを描画する
         * @param {object} stats - 集計結果
         */
        function drawChart(stats) {
            const processedData = [];
            for (const dept in stats) {
                // メンバーを利用回数の降順でソート
                const sortedMembers = stats[dept].members.sort((a, b) => b.value - a.value);
                
                processedData.push({
                    name: dept,
                    average: stats[dept].total / stats[dept].count,
                    count: stats[dept].count,
                    members: sortedMembers // ソート済みのメンバーリストを追加
                });
            }

            // 平均利用回数の降順でソート
            processedData.sort((a, b) => b.average - a.average);

            const labels = processedData.map(d => d.name);
            const averages = processedData.map(d => d.average);
            const counts = processedData.map(d => d.count);
            const membersLists = processedData.map(d => d.members); // メンバーリストの配列

            const ctx = document.getElementById('usageChart').getContext('2d');
            
            // グラデーションの作成
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(59, 130, 246, 0.8)'); // blue-500
            gradient.addColorStop(1, 'rgba(147, 197, 253, 0.8)'); // blue-300

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '平均利用回数',
                        data: averages,
                        // カスタムデータとして人数を保持
                        peopleCount: counts,
                        // カスタムデータとしてメンバー詳細リストを保持
                        membersList: membersLists, 
                        backgroundColor: gradient,
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                        hoverBackgroundColor: 'rgba(37, 99, 235, 1)', // blue-600
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '平均利用回数',
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                padding: { top: 10, bottom: 10 }
                            },
                            grid: {
                                color: 'rgba(200, 200, 200, 0.2)', // グリッド線を薄く
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: '部門',
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                padding: { top: 10, bottom: 10 }
                            },
                            grid: {
                                display: false, // X軸のグリッド線を非表示
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // データセットが1つのため凡例は非表示
                        },
                        tooltip: {
                            backgroundColor: '#1F2937', // gray-800
                            titleFont: {
                                size: 16,
                                weight: 'bold',
                            },
                            bodyFont: {
                                size: 14,
                            },
                            padding: 12,
                            cornerRadius: 6,
                            callbacks: {
                                label: function(context) {
                                    const dataset = context.dataset;
                                    const index = context.dataIndex;
                                    const avg = context.parsed.y;
                                    const count = dataset.peopleCount[index];
                                    const members = dataset.membersList[index];

                                    const MAX_MEMBERS_TO_SHOW = 10; // ツールチップに表示する最大人数

                                    let lines = [];
                                    lines.push(`平均利用回数: ${avg.toFixed(2)} 回`);
                                    lines.push(`対象人数: ${count}人`);
                                    lines.push(`--- 詳細 (上位${Math.min(members.length, MAX_MEMBERS_TO_SHOW)}名) ---`);

                                    // 上位メンバーを表示
                                    for (let i = 0; i < members.length && i < MAX_MEMBERS_TO_SHOW; i++) {
                                        lines.push(` ${i + 1}. ${members[i].name}: ${members[i].value} 回`);
                                    }

                                    // 上限を超えた場合は省略表示
                                    if (members.length > MAX_MEMBERS_TO_SHOW) {
                                        lines.push(` ...他 ${members.length - MAX_MEMBERS_TO_SHOW} 名`);
                                    }

                                    return lines;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }
    </script>
</body>
</html>

